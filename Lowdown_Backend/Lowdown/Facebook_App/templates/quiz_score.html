{% extends 'base.html' %}
{% load staticfiles %}
{% block scripts %}
<script type="text/javascript">
	window.fbAsyncInit = function() {
		FB.init({
			appId      : '{{app_id}}',
			xfbml      : true,
			version    : 'v2.1'
		});
	};

	(function(d, s, id){
		var js, fjs = d.getElementsByTagName(s)[0];
		if (d.getElementById(id)) {return;}
		js = d.createElement(s); js.id = id;
		js.src = "//connect.facebook.net/en_US/sdk.js";
		fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));
</script>
<script type="text/javascript">
	(function(){
		"use strict";
		$(document).ready(function(){
			$(".share_btn").click(function(){
				FB.ui({
					method: 'feed',
					name: "Lowdown Friend Quiz",
					link: '{{full_url}}',
					caption: 'Lowdown: The auto-generated Facebook Quiz!',
					to: '{{friend_id}}',
					description: '{{share_message}}',
					picture: 'http://revelationnow.net/wp-content/gallery/beyonce_demon_dance_face/01_angry_beyonce.jpg',
				}, function(response){});
			})
		});
	}());
</script>
{% endblock %}

{% block main %}
<link rel="stylesheet" type="text/css" href="{% static 'quiz.css' %}" />
<div>
	<div>
		{% if correct == 0 %}
			<h2> Oops! You've gotten {{ correct }} out of {{total_questions}}! </h2>
		{%else %}
			<h2> Congratulations! You've gotten {{ correct }} out of {{total_questions}}! </h2>
		{%endif%}
	</div>
	<button class="share_btn"> Share Results </button> 
    <div>
	{% for q in questions %}
		{% if q.image %}
			<img src="{{ q.image }}" alt="image" style="max-width: 50%;">
		{% endif %}
		<h2>{{forloop.counter}}. {{ q.question_text }}</h2>
		
		{% with question_number=forloop.counter0 %}
			{% for answer in q.responses %}
				{% if forloop.counter0 == q.correct_index %}
					<div id="correct_answer"> <input type="radio" name="question_{{ question_number }}" disabled {% if forloop.counter0 == q.checked %} checked {% endif %} value="{{ forloop.counter0 }}">{{ answer }} <br> </div>
				{% else %}
					<div {% if forloop.counter0 == q.checked %} id="incorrect_answer" {% endif %}> <input type="radio" name="question_{{ question_number }}" disabled {% if forloop.counter0 == q.checked %} checked {% endif %} value="{{ forloop.counter0 }}">{{ answer }}<br> </div>
				{% endif %}
			{% endfor %}
			<br>
		{% endwith %}
	{% endfor %}   
</div>
</div>
{% endblock %}
